/*! */
W.define("nearestStations",["rootScope","utils","http","overlays","$","plugins","nearestUtils"],function(e,n,t,a,r,o,i){var l=o["nearest-stations"];return function(o){var s,c,u,d=o.el,m=r(".circle",d),f=r("small",m),v=!0,p=!0,g=function(){return d.classList.remove("show")};return d.onclick=function(){l.domEl=d,l.open({params:s,data:c,firstOpening:p}),p=!1},{load:function(o){l.close(),s&&n.isNear(o,s)||t.get("/pois/stations/"+o.lat+"/"+o.lon).then(function(n,t){var o=t.data;if(!o||!o.length)return s=null,void g();c=o,s=n;var l=o.map(function(e){return{temp:i.giveMeTemp(e),wind:i.giveMeWind(e)}}).filter(function(e){return e.temp||e.wind}),p=l.length;if(p){var b=0;clearInterval(u);var w=function(){var e=l[b],n=e.temp,t=e.wind;m.style.backgroundColor=n?n.color:"#ddd",m.dataset.content=n?a.temp.convertNumber(n.K)+"Â°":"---",f.style.backgroundColor=t?t.color:"#ddd",f.textContent=t?t.value:"---",++b>=p&&(b=0)};u=setInterval(w,3e3),g(),setTimeout(function(){return d.classList.add("show")},1e3),w(),e.isMobile&&v&&(setTimeout(function(){r("span[data-t]",d).classList.remove("show")},6e3),v=!1)}else g()}.bind(null,o))},close:function(){clearInterval(u),d.classList.remove("show"),l.close(),s=null}}}}),
/*! */
W.define("nearestUtils",["overlays"],function(e){return{giveMeTemp:function(n){if("number"==typeof n.temp){var t=n.temp+273.15;return{color:e.temp.c.colorDark(t,-80),K:t}}return null},giveMeWind:function(n){return"number"==typeof n.wind?{color:e.wind.c.colorDark(n.wind,-80),value:e.wind.convertValue(n.wind)}:null}}}),
/*! */
W.define("nearestWebcams",["utils","rootScope","broadcast","$","http"],function(e,n,t,a,r){return function(o){var i,l=o.el,s=a(".circle",l),c=!0,u=null;l.onclick=function(){return t.emit("rqstOpen",n.isMobile?"webcam":"detail-webcams",u)};var d=function(e){return e&&e.image&&e.image.daylight.thumbnail},m=function(){clearInterval(i),l.classList.remove("show"),u=null},f=function(e){var t=e.length,r=0;clearInterval(i),t&&(i=setInterval(function(){var n=e[r];s.style.backgroundImage="url('"+d(n)+"')",++r>=t&&(r=0)},3e3),s.style.backgroundImage="url('"+d(e[0])+"')",l.classList.add("show"),n.isMobile&&c&&(setTimeout(function(){a("span[data-t]",l).classList.remove("show")},6e3),c=!1))};return{load:function(t){u&&e.isNear(t,u)||(m(),u=t,l.parentNode.dataset.webcams="loading",r.get("/node/webcams2/"+t.lat+"/"+t.lon).then(function(e){var t=e.data;t&&t.length>0?(function(e){var t=document.createDocumentFragment(),a=e.length,r=function(){return!--a&&f(e)};e.forEach(function(e){var a=new Image;n.isMobile&&t.appendChild(a),a.onload=r,a.onerror=r,a.src=d(e)})}(t=t.slice(0,7)),l.parentNode.dataset.webcams="loaded"):l.parentNode.dataset.webcams="empty"}))},close:m}}}),
/*! */
W.define("nearest",["nearestStations","nearestWebcams"],function(e,n){return{stations:e,webcams:n}});