/*! */
W.define("oldAnimation",["store"],function(t){var e,a,n=null,i=null,s=null,r=!1,o="off"===t.get("particlesAnim");function l(){cancelAnimationFrame(s)}function c(t){if(t?e=t:t=e,a=t.canvas,cancelAnimationFrame(s),!o){var r=a.getContext("2d"),l=t.partObj,c=t.width,h=t.height,d=t.vectors,f=0|l.getAmount.call(l,t);(!n||n.length<3*f)&&(n=new Float32Array(3*f),i=new Float32Array(3*f));var m=l.getMaxAge(),u="wavecle"===l.animation,g=l.getStyles.call(l,t);r.clearRect(0,0,t.width,t.height);for(var p,v,y,b=(p=c,v=h,y=m,function(t){var e=n;e[t++]=Math.random()*p,e[t++]=Math.random()*v,e[t++]=0,e[t++]=0,e[t++]=Math.floor(Math.random()*y),e[t]=0}),P=0,M=0;P<f;P++,M+=6)b(M);r.lineWidth=l.getLineWidth.call(l,t),r.fillStyle="rgba(0, 0, 0,"+l.getBlendingAlpha.call(l,t)+")";var A=l.getIntensityFun.call(l,t),w=0;!function t(e){if(s=requestAnimationFrame(t),!(e-w<35)){w=e;var a,o,l,p,v,y,P,M,C,T=r,F=n,O=i,R=6*f|0,k=d,V=0|c,j=0|Math.ceil(c/2),G=0|h,L=g,S=m,q=0,x=0,W=0;if(u)for(q=0;q<R;q+=6)F[q+4]>S&&b(q),a=F[q],o=F[q+1],W=3*(Math.round(.5*o)*j+Math.round(.5*a)),a>V||o>G||a<0||o<0?(F[q+4]=S+1,O[q+5]=10):(v=a+(l=k[W]),y=o+(p=k[W+1]),F[q]=v,F[q+1]=y,F[q+4]++,M=l/(P=Math.sqrt(l*l+p*p)/2.5),C=p/P,O[q]=a-C,O[q+1]=o+M,O[q+2]=a+C,O[q+3]=o-M,O[q+5]=A(F[q+4]));else for(q=0;q<R;q+=6)F[q+4]>S&&b(q),a=F[q],o=F[q+1],W=3*(Math.round(.5*o)*j+Math.round(.5*a)),a>V||o>G||a<0||o<0?(F[q+4]=S+1,F[q+5]=10):(F[q+2]=a+k[W],F[q+3]=o+k[W+1],F[q+4]++,F[q+5]=k[W+2]);if(T.globalCompositeOperation="destination-in",T.fillRect(0,0,c,h),T.globalCompositeOperation="source-over",u)for(q=0;q<4;q++){for(T.beginPath(),T.strokeStyle=L[q],x=0;x<R;x+=6)O[x+5]===q&&(T.moveTo(O[x],O[x+1]),T.lineTo(O[x+2],O[x+3]));T.stroke()}else for(q=0;q<4;q++){for(T.beginPath(),T.strokeStyle=L[q],x=0;x<R;x+=6)F[x+5]===q&&(T.moveTo(F[x],F[x+1]),T.lineTo(F[x+2],F[x+3]),F[x]=F[x+2],F[x+1]=F[x+3]);T.stroke()}}}()}}return{suspend:function(){r=!0,l(),a.getContext("2d").clearRect(0,0,a.width,a.height)},enable:function(){r=!1},run:c,stop:l,toggle:function(t){"off"===t?(o=!0,a.style.opacity=0,l()):o&&(o=!1,a.style.opacity=1,c(),r||c())}}}),
/*! */
W.define("particlesOld",["oldAnimation","map","store","render","particles","utils","DataTiler"],function(t,e,a,n,i,s,r){var o=new L.CanvasLayer({disableAutoReset:!0}),l=[];var c=r.instance({cancelRqstd:!1,latestParams:null,enabled:!0,cancelTasks:function(){this.syncCounter++},tilesReady:function(t,e,a){Object.assign(e,a),e.partObj=i[a.particlesIdent],this.computeVectors(e,t)},redrawVectors:function(){this.mapMoved=!0,this.latestParams&&this.getTiles(this.latestParams)},init:function(t){this.latestParams=s.clone(t),this.redrawVectors()},paramsChanged:function(t){this.latestParams&&this.latestParams.fullPath===t.fullPath&&this.latestParams.overlay===t.overlay?n.emit("rendered","particles"):(this.latestParams=s.clone(t),this.getTiles(this.latestParams))},computeVectors:function(e,a){var i=this.shift,s=this.lShift,r=this.offsetX,c=this.offsetY,h=this.trans,d=this.trans*this.trans,f=!1;this.latestParams.JPGtransparency?f=n.testJPGtransparency:this.latestParams.PNGtransparency&&(f=n.testPNGtransparency);var m,u,g,p,v,y,b,P,M,A,w=!1,C=this.w,T=0,F=0,O=0,R=0|e.height,k=0|e.width,V=0|Math.ceil(k/2),j=function(t,e){var a=3*(t>>1)*(10+(e>>1));return l.length>=a?l:l=new Float32Array(a)}(k,R),G=0,L=0,S=0,q=0,x=this.offset,W=256,I=0,J=0,N=0,B=0,D=0,X=0,Y=0,z=0,E=0,H=0,K=0,Q=0,U=0,Z=0,$=0,_=0,tt=0,et=0,at=e.partObj.getVelocityFun(e),nt=e.partObj.getIntensityFun(),it=0;F=0,B=c;for(var st=a.length;F<R;){for(X=(J=B>>i)-((q=J>>8)<<8),z=B-(J<<i),w=q<0&&q>=st,O=0,N=r;O<k;O+=2,N+=2)Y=N-((I=N>>i)<<i),q>=0&&q<st?W!==I&&(D=I-((S=I>>8)<<8),(m=a[q][S])?(u=m.data,G=x+D+((X<<8)+X)<<2,f&&(w=f(u,G)),E=u[G],H=u[G+4],U=u[G+1],Z=u[G+5],K=u[G+=1028],Q=u[G+4],$=u[G+1],_=u[G+5]):w=!0,W=I):w=!0,w?(j[L++]=0,j[L++]=0,j[L++]=0):(C?(tt=E*C[T=Y+(z<<i)<<2]+H*C[T+1]+K*C[T+2]+Q*C[T+3]>>s,et=U*C[T]+Z*C[T+1]+$*C[T+2]+_*C[T+3]>>s):(tt=(E*(y=(h-z)*(h-Y))+H*(b=(h-z)*Y)+K*(P=z*(h-Y))+Q*(M=Y*z))/d,et=(U*y+Z*b+$*P+_*M)/d),g=m.decodeR(tt),p=m.decodeG(et),A=at(v=Math.sqrt(g*g+p*p)),j[L++]=g*A,j[L++]=p*-A,j[L++]=nt(v),it+=v);B+=2,L=3*((F+=2)>>1)*V}this.mapMoved&&(o.reset.call(o),this.mapMoved=!1),e.speed2pixel=it/(k*R),e.vectors=j,e.canvas=o.getCanvas(),t.run(e),n.emit("rendered","particles")}}),h=c.redrawVectors.bind(c),d=c.cancelTasks.bind(c);function f(t){t?h():d()}return{open:function(n){o.addTo(e),o.getCanvas().classList.add("particles-layer"),e.on("moveend",h),e.on("movestart",d),a.on("particlesAnim",t.toggle),a.on("visibility",f),t.enable(),c.init(n)},close:function(){t.suspend(),a.off("particlesAnim",t.toggle),a.off("visibility",f),e.off("moveend",h),e.off("movestart",d),e.removeLayer(o)},redraw:h,paramsChanged:c.paramsChanged.bind(c)}});