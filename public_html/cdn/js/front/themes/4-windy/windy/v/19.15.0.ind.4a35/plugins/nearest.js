/*! */
W.define("NearestWebcams",["Webcams","utils","rootScope","broadcast"],function(n,e,s,a){return n.extend({maxAmount:7,toOpen:s.isMobile?"webcam":"detail-webcams",_init:function(){var t=this;this.firstLaunch=!0,this.latestParams=null,this.webcamsEl.onclick=function(){return a.emit("rqstOpen",t.toOpen,t.latestParams)}},getThumb:function(t){return t&&t.image&&t.image.daylight.thumbnail},close:function(){clearInterval(this.timer),this.webcamsEl.classList.remove("show"),this.latestParams=null},render:function(){var e=this,a=document.createDocumentFragment(),t=this.data.length,i=function(){return!--t&&e.onLoaded(a)};this.data.forEach(function(t){var n=new Image;s.isMobile&&a.appendChild(n),n.onload=i,n.onerror=i,n.src=e.getThumb(t)})},onLoaded:function(){var n=this,e=this.data.length,a=0;clearInterval(this.timer),e&&(this.timer=setInterval(function(){var t=n.data[a];n.webcamsImg.style.backgroundImage="url('"+n.getThumb(t)+"')",e<=++a&&(a=0)},3e3),this.webcamsImg.style.backgroundImage="url('"+this.getThumb(this.data[0])+"')",this.webcamsEl.classList.add("show"),s.isMobile&&this.firstLaunch&&(setTimeout(function(){n.webcamsImg.nextSibling.textContent=""},5e3),this.firstLaunch=!1))},load:function(t){this.latestParams&&e.isNear(t,this.latestParams)||(this.close(),this.latestParams=t,n.load.call(this,t))}})}),
/*! */
W.define("nearestStations",["rootScope","utils","http","overlays","broadcast","map","ClickHandler"],function(c,m,n,u,a,i,d){return function(t){var s=t.el,o=t.container;d.instance({el:s,marker:null,stopPropagation:!0,click:function(t,n,e){a.emit("rqstClose","detail"),a.emit("rqstOpen","station",{id:e,source:"nearest-stations"})}});var e=null,r=function(t,n){e=L.marker([+t,+n],{icon:i.myMarkers.icon}).addTo(i)},l=function(){e&&i.removeLayer(e)};return function(e,a){var i=e.id;n.get("/pois/stations/"+e.lat+"/"+e.lon).then(function(t){var n=t.data;i&&n&&n.length&&(n=n.filter(function(t){return t.id!==i})),n&&n.length?(function(t,n,e){var a=n.maxStations||6;t.length>a&&(t.length=a);var i=t.map(function(t){t.name&&(t.name=t.name.replace(/^[A-Z0-9]{4,8}\s/,""),12<t.name.length&&(t.name=t.name.substr(0,18)));var n=t.hAgo?t.hAgo+"h ago":t.minAgo+"m ago",e=Math.floor(t.dist)+"km";return'<div class="wx" data-wx="true" data-do="'+t.lat+","+t.lon+","+t.id+'">\n\t\t\t\t\t\t'+t.name+": "+n+", "+e+"\n\t\t\t\t\t\t"+function(t){var n="number"==typeof t.wind,e="number"==typeof t.temp,a=e?u.temp.c.colorDark(t.temp+273.15,-80):"transparent",i=n?u.wind.c.colorDark(t.wind,-80):"transparent";return'<span class="station-box-temp  wx-'+t.type+'" style="background-color:'+a+';">\n\t\t\t\t'+(e?u.temp.convertValue(t.temp+272.15):"---")+'\n\t\t\t</span>\n\t\t\t<span class="station-box-wind" data-icon="&#xe024;" style="background-color:'+i+';">\n\t\t\t\t'+(n?m.windDir2html(t)+u.wind.convertValue(t.wind):"---")+"\n\t\t\t</span>"}(t)+"\n\t\t\t\t\t</div>"}).join("");t.length&&(i+='<div class="fg-gray size-xs clickable" data-ref="report-station"\n\t\t\t\t\tdata-do="url,https://stations.windy.com">Add your station to Windy</div>'),o.innerHTML=i,c.isTouch||o.querySelectorAll("div[data-wx]").forEach(function(t){var n=t.dataset.do.split(","),e=n[0],a=n[1];t.onmouseover=r.bind(null,+e,+a),t.onmouseout=l}),o.style.height=n.height+"px",s.style["min-width"]=o.style["min-width"]=3<t.length?"440px":null,e&&e()}(n,e,a),s.style.display="inline-block"):s.style.display="none"})}}});